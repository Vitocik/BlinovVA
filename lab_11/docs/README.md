# Отчет по лабораторной работе №11  
# Алгоритмы на строках

**Дата:** 2025-12-11
**Семестр:** 3 курс, 1 полугодие (5 семестр)
**Группа:** ПИЖ-б-о-23-2(2)
**Дисциплина:** Анализ сложности алгоритмов
**Студент:** Блинов Виктор Александрович

---

## Цель работы
Изучить специализированные алгоритмы обработки строк, реализовать вычисление префикс-функции, Z-функции, алгоритм Кнута–Морриса–Пратта (КМП), Рабина–Карпа, а также выполнить анализ производительности различных алгоритмов поиска подстроки. Получить навыки визуализации результатов и решения прикладных задач на основе изученных методов.

---

## Теоретическая часть

### Префикс-функция
Префикс-функция π[i] задаёт длину максимального собственного префикса строки, совпадающего с суффиксом подстроки, заканчивающейся на позиции *i*.  
Вычисляется за **O(n)**. Используется в КМП.

### Алгоритм Кнута–Морриса–Пратта (КМП)
Алгоритм линейного поиска подстроки со сложностью **O(n + m)**.  
Использует предварительно вычисленную префикс-функцию.

### Z-функция
Z-функция для строки S определяет длину совпадающего с префиксом строки суффикса, начинающегося в позиции *i*.  
Вычисляется за **O(n)**.

### Алгоритм Рабина–Карпа
Алгоритм поиска подстроки, основанный на полиномиальном хэше.  
Средняя сложность — **O(n + m)**, худшая — **O(n·m)**.

### Прикладные задачи
- поиск всех вхождений подстроки;
- определение периода строки;
- проверка циклического сдвига.

---

## Практическая часть

### Выполненные задачи
- [x] Реализована префикс-функция  
- [x] Реализован алгоритм КМП  
- [x] Реализована Z-функция  
- [x] Реализован поиск подстроки с помощью Z-функции  
- [x] Реализован алгоритм Рабина–Карпа  
- [x] Написаны модульные тесты  
- [x] Построены графики производительности  
- [x] Реализованы прикладные задачи:
  - поиск всех вхождений,
  - поиск периода строки,
  - проверка циклического сдвига

---

## Ключевые фрагменты кода

#### Префикс-функция
```python
def prefix_function(s: str) -> list[int]:
    pi = [0] * len(s)
    j = 0
    for i in range(1, len(s)):
        while j > 0 and s[i] != s[j]:
            j = pi[j - 1]
        if s[i] == s[j]:
            j += 1
        pi[i] = j
    return pi
```

#### Алгоритм КМП
```python
def kmp_search(text: str, pattern: str) -> list[int]:
    if not pattern:
        return []
    combined = pattern + "#" + text
    pi = prefix_function(combined)
    m = len(pattern)
    return [i - 2 * m for i in range(m + 1, len(combined)) if pi[i] == m]
```

#### Z-функция
```python
def z_function(s: str) -> list[int]:
    z = [0] * len(s)
    l = r = 0
    for i in range(1, len(s)):
        if i <= r:
            z[i] = min(r - i + 1, z[i - l])
        while i + z[i] < len(s) and s[z[i]] == s[i + z[i]]:
            z[i] += 1
        if i + z[i] - 1 > r:
            l, r = i, i + z[i] - 1
    return z
```

---

## Результаты выполнения

### Пример работы программы

```bash
Текст:   ababcabcababc
Паттерн: abc

KMP:        [2, 5, 10]
Z-search:   [2, 5, 10]
Rabin–Karp: [2, 5, 10]

Строка: abababab
Период: 2

a = 'abcdef'
b = 'defabc'
b является циклическим сдвигом a: True
```

---

## Тестирование

- [x] Модульные тесты пройдены  
- [x] Производительность оценена и проанализирована  

---

## Выводы

1. Были изучены и реализованы эффективные линейные алгоритмы обработки строк.  
2. Проведено сравнение алгоритмов поиска подстроки и выявлена разница в их производительности.  
3. π-функция и Z-функция позволяют эффективно решать широкий спектр задач, связанных  
   с периодами строки, совпадениями и циклическими сдвигами.  

---

## Ответы на контрольные вопросы

1. **Что такое префикс-функция? Как она используется в алгоритме Кнута-Морриса-Пратта (KMP)?**  
   Префикс-функция задаёт длину наибольшего собственного префикса, совпадающего с суффиксом.  
   Позволяет КМП избегать повторных сравнений и работать за O(n + m).

2. **В чем основное преимущество алгоритма KMP перед наивным алгоритмом поиска подстроки? Проиллюстрируйте на примере.**  
   КМП не откатывается назад по тексту и использует информацию π-функции для пропуска лишних сравнений.

3. **Опишите, что такое Z-функция строки. Как с ее помощью можно решить задачу поиска подстроки?**  
   Значение Z[i] — длина наибольшего префикса строки, совпадающего с её суффиксом, начинающимся с позиции i.

4. **В чем заключается идея алгоритма Бойера-Мура? Какие эвристики он использует для ускорения поиска?**  
   Использует эвристики “плохого символа” и “хорошего суффикса” для больших прыжков по тексту.

5. **Для каких практических задач, помимо поиска подстроки, могут применяться префикс- и Z функции (например, поиск периода строки)?**  
   - поиск подстрок  
   - нахождение периода строки  
   - поиск повторяющихся подстрок  
   - проверка циклического сдвига  
   - биоинформатика (геномные последовательности)

---

## Приложения
- Исходный код:  
  - `kmp_search.py`  
  - `prefix_function.py`  
  - `rabin_karp.py`  
  - `string_matching.py`  
  - `string_tasks.py`
  - `string_visualization.py`
  - `tests.py`
- Графики:  
  - `prefix_demo.png`  
  - `time_vs_pattern.png`
  - `time_vs_text.png`
  - `z_demo.png`
